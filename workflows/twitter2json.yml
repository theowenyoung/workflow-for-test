on:
  twitter:
    api: statuses/user_timeline
    auth:
      consumer_key: ${{ secrets.TWITTER_CONSUMER_KEY }}
      consumer_secret: ${{ secrets.TWITTER_CONSUMER_SECRET }}
      access_token: ${{ secrets.TWITTER_ACCESS_TOKEN }}
      access_token_secret: ${{ secrets.TWITTER_ACCESS_SECRET }}
    params:
      screen_name: theowenyoung
      count: 8
    fetchAllResultsAtFirst: true
    maxCount: 8
    config:
      active: false
      outputsMode: combine
      outputsLength: 2
      force: true
      manualRunEvent:
        - workflow_dispatch
        - push
jobs:
  print:
    name: Print
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
        with:
          persist-credentials: false
          fetch-depth: 0
      - run: ls -l data/tweets
      - name: create tweet json
        id: create-json
        uses: actions/github-script@v3
        with:
          script: |
            const fs = require('fs')
            const createFile = (path, content)=>{
              return new Promise((resolve,reject)=>{
                fs.writeFile(path,content,(e)=>{
                  if(e){
                    return reject(e)
                  }else{
                    return resolve()
                  }
                })
              })
            }
            const test =  ${{on.twitter.outputs.length}}
            console.log('test',test)
            return test

      - run: ls -l data/tweets
      - name: Commit & Push changes
        uses: actions-js/push@master
        if: false
        with:
          github_token: ${{ secrets.GITHUB_TOKEN }}
      - uses: actions-go/push@master
        if: false
        with:
          commit-message: '[Auto] update pre-puilt dist packages'
        remote: origin
